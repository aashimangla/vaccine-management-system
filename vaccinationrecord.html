<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vaccination Records</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Vaccination Records</h2>
        <table class="table table-striped" id="recordsTable">
            <thead>
                <tr>
                    <th>Child Name</th>
                    <th>Date of Birth</th>
                    <th>Gender</th>
                    <th>Vaccines</th>
                </tr>
            </thead>
            <tbody id="recordsTableBody">
                <!-- Records will be populated from database -->
            </tbody>
        </table>
    </div>
    <script>
       document.addEventListener('DOMContentLoaded', async () => {
  const recordsTableBody = document.getElementById('recordsTableBody');

  try {
    // Fetch data from the backend
    const response = await fetch('http://localhost:3000/api/childvaccinations'); // Ensure the port matches your server
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    const records = await response.json();

    // Populate table with fetched data
    if (records.length > 0) {
      recordsTableBody.innerHTML = records.map(record => `
        <tr>
          <td>${record.childName}</td>
          <td>${new Date(record.dateOfBirth).toLocaleDateString()}</td>
          <td>${record.gender}</td>
          <td>
            ${record.vaccines.map(vaccine => `${vaccine.name} (Administered: ${new Date(vaccine.dateAdministered).toLocaleDateString()})`).join(', ')}
          </td>
        </tr>
      `).join('');
    } else {
      recordsTableBody.innerHTML = '<tr><td colspan="4">No records found.</td></tr>';
    }
  } catch (error) {
    console.error('Error fetching records:', error);
    recordsTableBody.innerHTML = '<tr><td colspan="4">Failed to fetch records.</td></tr>';
  }
});

      </script>
      
</body>
</html>